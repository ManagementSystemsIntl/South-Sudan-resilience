*******************************************************************
* South Sudan Baseline Household Survey
* Sean Kelly
* July 20, 2021
* File uses: mesp_household_baseline_survey_didinga.xlsx
* File saves: mesp_household_pilot_survey_nuer_preprocessed.dta
* mesp_household_pilot_survey_nuer_hh_schedule_preprocessed.dta
* This file takes the raw data and applies a standardized codebook
*******************************************************************

*Create file paths
local inpath "W:\Shared\Projects\6073.04 SSD MESP\Tech\Deliverables\Household Survey\Baseline\data\00_raw_data\"
local outpath "W:\Shared\Projects\6073.04 SSD MESP\Tech\Deliverables\Household Survey\Baseline\data\01_preprocess\"

**********************
* Main Questionnaire *
**********************

*Import raw dataset
import excel using "`inpath'mesp_household_baseline_survey_didinga.xlsx", firstrow sheet("mesp_household_baseline_survey_") clear

rename M q_101
rename _204 q_201_204
rename O q_205
rename P q_206
rename Q q_207
rename R q_208
rename S q_209
rename _a q_210_a
rename U q_210_b
rename V q_211
rename W q_212
rename eet_cig_halanguto household_members
rename Y q_401_a
rename Z q_401_b
rename _c q_401_c
rename _d q_401_d
rename _e q_401_e
rename _f q_401_f
rename _g q_401_g
rename _h q_401_h
rename _i q_401_i
rename _j q_401_j
rename _k q_401_k
rename _l q_401_l
rename _m q_401_m
rename AL q_401_n
rename _o q_401_o
rename _p q_401_p
rename _q q_401_q
rename _r q_401_r
rename _s q_401_s
rename _t q_401_t
rename _u q_401_u
rename _u_specify q_401_u_specify
rename AU q_402_a
rename AV q_402_b
rename AW q_402_c
rename AX q_402_d
rename AY q_402_e
rename AZ q_402_f
rename BA q_402_g
rename BB q_402_h
rename BC q_402_i
rename BD q_402_j
rename BE q_402_k
rename BF q_402_l
rename BG q_402_m
rename BH q_402_n
rename BI q_402_o
rename BJ q_402_p
rename BK q_402_q
rename BL q_402_r
rename BM q_402_s
rename BN q_402_t
rename BO q_402_u
rename geen_ci_ngerenitoo q_breakfast
rename gii_ci_dipili_ci_adahii q_snack_1
rename geen_ci_aduhii_haati_aauu_kora_l q_lunch
rename snack_2 q_snack_2
rename geen_ci_jiaatinu q_dinner
rename snack_3 q_snack_3
rename BV q_403
rename BW q_404
rename BX q_405
rename BY q_406
rename BZ q_407
rename CA q_408
rename CB q_409
rename CC q_410
rename CD q_411
rename CE q_412
rename CF q_413
rename CG q_414
rename CH q_415
rename CI q_416
rename CJ q_417
rename CK q_418
rename CL q_419
rename CM q_420
rename CN q_421
rename CO q_422
rename CP q_423
rename CQ q_424
rename CR q_425
rename CS q_426
rename CT q_427
rename CU q_428
rename CV q_429
rename CW q_430
rename CX q_431
rename CY q_432
rename CZ q_433
rename DA q_434
rename DB q_435
rename DC q_436
rename DD q_437
rename DE q_438
rename DF q_439
rename DG q_440
rename DH q_441
rename DI q_442
rename DJ q_443
rename DK q_444
rename DL q_445
rename DM q_446
rename DN q_447
rename DO q_448
rename DP q_449
rename DQ q_450
rename DR q_451
rename DS q_452
rename DT q_453
rename DU q_455
rename DV q_456
rename DW q_457
rename DX q_458
rename DY q_459
rename DZ q_460
rename EA q_461
rename EB q_462
rename EC q_463
rename ED q_464
rename EE q_465
rename EF q_466
rename EG q_468
rename EH q_469
rename EI q_470
rename EJ q_471
rename EK q_472
rename EL q_473
rename EM q_474
rename EN q_475
rename EO q_476
rename EP q_477
rename EQ q_478
rename ER q_479
rename ES q_480
rename ET q_481
rename EU q_482
rename EV q_483
rename EW q_484
rename EX q_485
rename EY q_486
rename EZ q_488
rename FA q_489
rename FB q_490
rename FC q_491
rename FD q_492
rename FE q_493
rename FF q_494
rename FG q_495
rename FH q_496
rename FI q_497
rename FJ q_498
rename a q_501a
rename b q_501b
rename c q_501c
rename d q_501d
rename e q_501e
rename f q_501f
rename g q_501g
rename h q_501h
rename i q_501i
rename j q_501j
rename k q_501k
rename l q_501l
rename m q_501m
rename n q_501n
rename o q_501o
rename p q_501p
rename GA q_502a
rename GB q_502b
rename GC q_502c
rename GD q_502d
rename GE q_502e
rename GF q_502f
rename GG q_502g
rename GH q_502h
rename GI q_502i
rename GJ q_502j
rename GK q_502k
rename GL q_502l
rename GM q_502m
rename GN q_502n
rename GO q_502o
rename GP q_502p
rename GQ q_503a
rename GR q_503b
rename GS q_503c
rename GT q_503d
rename GU q_503e
rename GV q_503f
rename GW q_503g
rename GX q_503h
rename GY q_503i
rename GZ q_503j
rename HA q_503k
rename HB q_503l
rename HC q_503m
rename HD q_503n
rename HE q_503o
rename HF q_503p
rename HG q_504
rename _1 q_505_1
rename _2 q_505_2
rename _3 q_505_3
rename _4 q_505_4
rename _5 q_505_5
rename _6 q_505_6
rename _7 q_505_7
rename _8 q_505_8
rename _9 q_505_9
rename _10 q_505_10
rename _11 q_505_11
rename _12 q_505_12
rename _13 q_505_13
rename _14 q_505_14
rename _15 q_505_15
rename _16 q_505_16
rename _17 q_505_17
rename _18 q_505_18
rename _19 q_505_19
rename _20 q_505_20
rename __21 q_505__21
rename _22 q_505_22
rename _22_specify q_505_22_specify
rename IE q_506_1
rename IF q_506_2
rename IG q_506_3
rename IH q_506_4
rename II q_506_5
rename IJ q_506_6
rename IK q_506_7
rename IL q_506_8
rename IM q_506_9
rename IN q_506_10
rename _10_specify q_506_10_specify
rename IP q_507_1
rename IQ q_507_2
rename IR q_507_3
rename IS q_507_4
rename IT q_507_5
rename IU q_507_6
rename IV q_508
rename IW q_509
rename IX q_509_a
rename IY q_510
rename IZ q_511
rename JA q_512_1
rename JB q_512_2
rename JC q_512_3
rename JD q_512_4
rename JE q_512_5
rename JF q_512_6
rename JG q_512_7
rename JH q_512_8
rename _8_specify q_512_8_specify
rename JJ q_513
rename JK q_514
rename JL q_515
rename JM q_516
rename JN q_517
rename JO q_518_1
rename JP q_518_2
rename JQ q_518_3
rename JR q_518_4
rename JS q_518_5
rename JT q_518_6
rename JU q_518_7
rename JV q_518_8
rename JW q_518_9
rename _9_specify q_518_9_specify
rename JY q_519
rename JZ q_520
rename KA q_601
rename KB q_602_1
rename KC q_602_2
rename KD q_602_3
rename KE q_602_4
rename KF q_602_5
rename KG q_602_6
rename KH q_602_7
rename KI q_602_8
rename KJ q_602_9
rename KK q_602_10
rename KL q_602_11
rename KM q_602_12
rename KN q_602_13
rename KO q_602_14
rename KP q_602_15
rename KQ q_602_16
rename KR q_602_17
rename _17_specify q_602_17_specify
rename KT q_603
rename KU q_604_1
rename KV q_604_2
rename KW q_604_3
rename KX q_604_4
rename KY q_604_5
rename KZ q_604_6
rename LA q_604_7
rename LB q_605
rename _specify q_605_specify
rename LD q_606
rename LE q_607_a
rename LF q_607_b
rename LG q_607_c
rename LH q_607_d
rename LI q_607_e
rename LJ q_607_f
rename LK q_607_g
rename LL q_607_h
rename LM q_607_i
rename LN q_607_j
rename LO q_607_k
rename LP q_608_a
rename LQ q_608_b
rename LR q_608_c
rename LS q_608_d
rename LT q_608_e
rename LU q_608_f
rename LV q_608_g
rename LW q_608_h
rename LX q_608_i
rename LY q_608_j
rename LZ q_608_k
rename MA q_609_a
rename MB q_609_b
rename MC q_609_c
rename MD q_609_d
rename ME q_609_e
rename MF q_609_g
rename MG q_609_h
rename MH q_609_i
rename MI q_609_j
rename MJ q_609_f
rename MK q_609_k
rename ML q_610
rename MM q_611
rename MN q_612
rename MO q_613_1
rename MP q_613_2
rename MQ q_613_3
rename MR q_613_4
rename MS q_613_5
rename MT q_613_6
rename MU q_613_7
rename _7_specify q_613_7_specify
rename MW q_613_8
rename MX q_613_9
rename MY q_614_1
rename MZ q_614_2
rename NA q_614_3
rename NB q_614_4
rename NC q_614_5
rename ND q_614_6
rename NE q_614_7
rename NF q_614_7_specify
rename NG q_614_8
rename NH q_614_9
rename NI q_615_1
rename NJ q_615_2
rename NK q_615_3
rename NL q_615_4
rename NM q_615_5
rename NN q_615_6
rename NO q_615_7
rename NP q_615_7_specify
rename NQ q_615_8
rename NR q_615_9
rename NS q_616_1
rename NT q_616_2
rename NU q_616_3
rename NV q_616_4
rename NW q_616_5
rename NX q_616_6
rename NY q_616_7
rename NZ q_616_7_specify
rename OA q_616_8
rename OB q_616_9
rename OC q_617
rename OD q_618_1
rename OE q_618_2
rename OF q_618_3
rename OG q_618_4
rename OH q_618_5
rename _5_specify q_618_5_specify
rename OJ q_618_8
rename OK q_618_9
rename OL q_619_1
rename OM q_619_2
rename ON q_619_3
rename OO q_619_4
rename OP q_619_5
rename OQ q_619_6
rename _6_specify q_619_6_specify
rename OS q_619_8
rename OT q_619_9
rename OU q_620
rename OV q_621_1
rename OW q_621_2
rename OX q_621_3
rename OY q_621_4
rename OZ q_621_5
rename PA q_621_5_specify
rename PB q_621_8
rename PC q_621_9
rename PD q_622_1
rename PE q_622_2
rename PF q_622_3
rename PG q_622_4
rename PH q_622_5
rename PI q_622_6
rename PJ q_622_6_specify
rename PK q_622_8
rename PL q_622_9
rename PM q_623
rename PN q_624_1
rename PO q_624_2
rename PP q_624_3
rename PQ q_624_4
rename PR q_624_5
rename PS q_624_5_specify
rename PT q_624_8
rename PU q_624_9
rename PV q_625_1
rename PW q_625_2
rename PX q_625_3
rename PY q_625_4
rename PZ q_625_5
rename QA q_625_6
rename QB q_625_6_specify
rename QC q_625_8
rename QD q_625_9
rename QE q_626
rename QF q_627_1
rename QG q_627_2
rename QH q_627_3
rename QI q_627_4
rename QJ q_627_5
rename QK q_627_5_specify
rename QL q_627_8
rename QM q_627_9
rename QN q_628_1
rename QO q_628_2
rename QP q_628_3
rename QQ q_628_4
rename QR q_628_5
rename QS q_628_6
rename QT q_628_6_specify
rename QU q_628_8
rename QV q_628_9
rename QW q_629
rename QX q_630
rename QY q_631
rename QZ q_632
rename RA q_633
rename RB q_634
rename RC q_635
rename RD q_636
rename RE q_637
rename RF q_638
rename RG q_701_1
rename RH q_701_2
rename RI q_701_3
rename RJ q_701_4
rename RK q_701_5
rename RL q_701_6
rename RM q_701_7
rename RN q_701_7_specify
rename RO q_702
rename RP q_703
rename RQ q_704
rename RR q_705_1
rename RS q_705_2
rename RT q_705_3
rename RU q_705_4
rename RV q_705_5
rename RW q_705_6
rename RX q_705_7
rename RY q_705_8
rename RZ q_705_9
rename SA q_705_10
rename SB q_705_10_specify
rename SC q_706
rename SD q_707
rename SE q_708
rename _08_specify q_708_08_specify
rename SG q_709
rename SH q_710
rename _11_specify q_710_11_specify
rename SJ q_711
rename SK q_712
rename SL q_713
rename SM q_714
rename SN q_715
rename SO q_716
rename SP q_717
rename SQ q_718
rename SR q_719
rename SS q_720
rename ST q_721
rename SU q_722
rename SV q_723
rename SW q_724
rename SX q_725
rename SY q_726
rename SZ q_727
rename TA q_728
rename TB q_729
rename TC q_730
rename TD q_731
rename TE q_732
rename TF q_733
rename TG q_734
rename TH q_801
rename TI q_801_6_specify
rename TJ q_802
rename TK q_803
rename TL q_804
rename TM q_805
rename TN q_806
rename TO q_807
rename TP q_808
rename TQ q_809
rename TR q_810
rename TS q_811
rename TT q_812
rename TU q_812_7_specify
rename TV q_813
rename TW q_813_7_specify
rename TX q_814
rename TY q_815
rename TZ q_816
rename UA q_817
rename UB q_818
rename UC q_819
rename UD q_820
rename UE q_821
rename UF q_822
rename UG q_823
rename UH q_824
rename UI q_825
rename UJ q_826
rename UK q_827
rename UL q_828
rename UM q_829
rename UN q_830
rename _new q_830_new
rename UP q_831
rename UQ q_831_new
rename UR q_832
rename US q_832_new
rename UT q_901

local numerics q_101 q_206 q_210_b q_211 q_401_a q_401_b q_401_c q_401_d q_401_e q_401_f q_401_g q_401_h q_401_i q_401_j q_401_k q_401_l q_401_m q_401_n q_401_o q_401_p q_401_q q_401_r q_401_s q_401_t q_401_u q_402_a q_402_b q_402_c q_402_d q_402_e q_402_f q_402_g q_402_h q_402_i q_402_j q_402_k q_402_l q_402_m q_402_n q_402_o q_402_p q_402_q q_402_r q_402_s q_402_t q_402_u q_403 q_404 q_405 q_406 q_407 q_408 q_409 q_410 q_411 q_412 q_413 q_414 q_415 q_416 q_417 q_418 q_419 q_420 q_421 q_422 q_423 q_424 q_425 q_426 q_427 q_428 q_429 q_430 q_431 q_432 q_433 q_434 q_435 q_436 q_437 q_438 q_439 q_440 q_441 q_442 q_443 q_444 q_445 q_446 q_447 q_448 q_449 q_450 q_451 q_452 q_453 q_455 q_456 q_457 q_458 q_459 q_460 q_461 q_462 q_463 q_464 q_465 q_466 q_468 q_469 q_470 q_471 q_472 q_473 q_474 q_475 q_476 q_477 q_478 q_479 q_480 q_481 q_482 q_483 q_484 q_485 q_486 q_488 q_489 q_490 q_491 q_492 q_493 q_494 q_495 q_496 q_497 q_498 q_501a q_501b q_501c q_501d q_501e q_501f q_501g q_501h q_501i q_501j q_501k q_501l q_501m q_501n q_501o q_501p q_502a q_502b q_502c q_502d q_502e q_502f q_502g q_502h q_502i q_502j q_502k q_502l q_502m q_502n q_502o q_502p q_503a q_503b q_503c q_503d q_503e q_503f q_503g q_503h q_503i q_503j q_503k q_503l q_503m q_503n q_503o q_503p q_504 q_505_1 q_505_2 q_505_3 q_505_4 q_505_5 q_505_6 q_505_7 q_505_8 q_505_9 q_505_10 q_505_11 q_505_12 q_505_13 q_505_14 q_505_15 q_505_16 q_505_17 q_505_18 q_505_19 q_505_20 q_505__21 q_505_22 q_506_1 q_506_2 q_506_3 q_506_4 q_506_5 q_506_6 q_506_7 q_506_8 q_506_9 q_506_10 q_506_10_specify q_507_1 q_507_2 q_507_3 q_507_4 q_507_5 q_507_6 q_508 q_509 q_509_a q_510 q_511 q_512_1 q_512_2 q_512_3 q_512_4 q_512_5 q_512_6 q_512_7 q_512_8 q_513 q_514 q_515 q_516 q_517 q_518_1 q_518_2 q_518_3 q_518_4 q_518_5 q_518_6 q_518_7 q_518_8 q_518_9 q_519 q_520 q_601 q_602_1 q_602_2 q_602_3 q_602_4 q_602_5 q_602_6 q_602_7 q_602_8 q_602_9 q_602_10 q_602_11 q_602_12 q_602_13 q_602_14 q_602_15 q_602_16 q_602_17 q_603 q_604_1 q_604_2 q_604_3 q_604_4 q_604_5 q_604_6 q_604_7 q_605 q_606 q_607_a q_607_b q_607_c q_607_d q_607_e q_607_f q_607_g q_607_h q_607_i q_607_j q_607_k q_608_a q_608_b q_608_c q_608_d q_608_e q_608_f q_608_g q_608_h q_608_i q_608_j q_608_k q_609_a q_609_b q_609_c q_609_d q_609_e q_609_g q_609_h q_609_i q_609_j q_609_f q_609_k q_610 q_611 q_612 q_613_1 q_613_2 q_613_3 q_613_4 q_613_5 q_613_6 q_613_7 q_613_8 q_613_9 q_614_1 q_614_2 q_614_3 q_614_4 q_614_5 q_614_6 q_614_7 q_614_8 q_614_9 q_615_1 q_615_2 q_615_3 q_615_4 q_615_5 q_615_6 q_615_7 q_615_8 q_615_9 q_616_1 q_616_2 q_616_3 q_616_4 q_616_5 q_616_6 q_616_7 q_616_8 q_616_9 q_617 q_618_1 q_618_2 q_618_3 q_618_4 q_618_5 q_618_8 q_618_9 q_619_1 q_619_2 q_619_3 q_619_4 q_619_5 q_619_6 q_619_6_specify q_619_8 q_619_9 q_620 q_621_1 q_621_2 q_621_3 q_621_4 q_621_5 q_621_8 q_621_9 q_622_1 q_622_2 q_622_3 q_622_4 q_622_5 q_622_6 q_622_6_specify q_622_8 q_622_9 q_623 q_624_1 q_624_2 q_624_3 q_624_4 q_624_5 q_624_8 q_624_9 q_625_1 q_625_2 q_625_3 q_625_4 q_625_5 q_625_6 q_625_8 q_625_9 q_626 q_627_1 q_627_2 q_627_3 q_627_4 q_627_5 q_627_8 q_627_9 q_628_1 q_628_2 q_628_3 q_628_4 q_628_5 q_628_6 q_628_6_specify q_628_8 q_628_9 q_629 q_630 q_631 q_632 q_633 q_634 q_635 q_636 q_637 q_638 q_701_1 q_701_2 q_701_3 q_701_4 q_701_5 q_701_6 q_701_7 q_702 q_703 q_704 q_705_1 q_705_2 q_705_3 q_705_4 q_705_5 q_705_6 q_705_7 q_705_8 q_705_9 q_705_10  q_706 q_707 q_708 q_708_08_specify q_709 q_710 q_711 q_713 q_715 q_717 q_719 q_721 q_723 q_725 q_727 q_729 q_731 q_733 q_801 q_802 q_803 q_804 q_805 q_806 q_807 q_808 q_809 q_810 q_811 q_812 q_813 q_814 q_815 q_816 q_817 q_818 q_819 q_820 q_821 q_822 q_823 q_824 q_825 q_826 q_827 q_828 q_829 q_830 q_830_new q_831 q_831_new q_832 q_832_new 

foreach num of local numerics {
destring `num', replace
}
*

*Apply codebook
applyCodebook using "`outpath'01_south_sudan_baseline_codebook_hh_survey.xlsx", rename varlab recode vallab

gen survey_name = "Didinga HH Survey"

*Save dataset as dta file
save "`outpath'mesp_household_baseline_survey_didinga_preprocessed.dta", replace

**********************
* Household Schedule *
**********************

*Import raw dataset
import excel using "`inpath'mesp_household_baseline_survey_didinga.xlsx", firstrow sheet("mesp_household_baseline_surve_1") clear

rename U q_301
rename V q_302
rename W q_303
rename X q_304
rename Y q_305
rename Z q_306
rename AA q_307
rename AB q_308
rename _8_specify q_308_8_specify
rename AD q_309
rename _7_specify q_309_7_specify
rename AF q_310
rename AG q_311
rename AH q_312
rename AI q_313
rename AJ q_314
rename _10 q_314_10_specify
rename AL q_315

local numerics q_302 q_303 q_304 q_305 q_306 q_307 q_308 q_309 q_310 q_311 q_312 q_313 q_314 q_315

foreach num of local numerics {
destring `num', replace
}
*

*Apply codebook
applyCodebook using "`outpath'01_south_sudan_baseline_codebook_hh_survey_hh_schedule.xlsx", rename varlab recode vallab

*Save dataset as dta file
save "`outpath'mesp_household_baseline_survey_didinga_hh_schedule_preprocessed.dta", replace
