*******************************************************************
* South Sudan Pilot Household Survey
* Sean Kelly
* April 1, 2021
* File uses: mesp_household_baseline_survey_juba_arabic.xlsx
* File saves: mesp_household_pilot_survey_juba_arabic_preprocessed.dta
* This file takes the raw data and applies a standardized codebook
*******************************************************************

*Create file paths
local inpath "W:\Shared\Projects\6073.04 SSD MESP\Tech\Deliverables\Household Survey\Pilot\data\00_raw_data\"
local outpath "W:\Shared\Projects\6073.04 SSD MESP\Tech\Deliverables\Household Survey\Pilot\data\01_preprocess\"

**********************
* Main Questionnaire *
**********************

*Import raw dataset
import excel using "`inpath'mesp_household_baseline_survey_juba_arabic.xlsx", firstrow sheet("mesp_household_baseline_survey_") clear

rename K q_101
rename _204 q_201_204
rename M q_205
rename N q_206
rename O q_207
rename P q_208
rename Q q_209
rename _a q_210_a
rename S q_210_b
rename T q_211
rename U q_212
rename W q_401_a
rename X q_401_b
rename _c q_401_c
rename _d q_401_d
rename _e q_401_e
rename _f q_401_f
rename _g q_401_g
rename _h q_401_h
rename _i q_401_i
rename _j q_401_j
rename _k q_401_k
rename _l q_401_l
rename _m q_401_m
rename AJ q_401_n
rename _o q_401_o
rename _p q_401_p
rename _q q_401_q
rename _r q_401_r
rename _s q_401_s
rename _t q_401_t
rename _u q_401_u
rename _u_specify q_401_u_specify
rename AS q_402_a
rename AT q_402_b
rename AU q_402_c
rename AV q_402_d
rename AW q_402_e
rename AX q_402_f
rename AY q_402_g
rename AZ q_402_h
rename BA q_402_i
rename BB q_402_j
rename BC q_402_k
rename BD q_402_l
rename BE q_402_m
rename BF q_402_n
rename BG q_402_o
rename BH q_402_p
rename BI q_402_q
rename BJ q_402_r
rename BK q_402_s
rename BL q_402_t
rename BM q_402_u
rename fotur q_breakfast
rename tahlia q_snack_1
rename gada_ q_lunch
rename snack_2 q_snack_2
rename asha_ q_dinner
rename snack_3 q_snack_3
rename BT q_403
rename BU q_404
rename BV q_405
rename BW q_406
rename BX q_407
rename BY q_408
rename BZ q_409
rename CA q_410
rename CB q_411
rename CC q_412
rename CD q_413
rename CE q_414
rename CF q_415
rename CG q_416
rename CH q_417
rename CI q_418
rename CJ q_419
rename CK q_420
rename CL q_421
rename CM q_422
rename CN q_423
rename CO q_424
rename CP q_425
rename CQ q_426
rename CR q_427
rename CS q_428
rename CT q_429
rename CU q_430
rename CV q_431
rename CW q_432
rename CX q_433
rename CY q_434
rename CZ q_435
rename DA q_436
rename DB q_437
rename DC q_438
rename DD q_439
rename DE q_440
rename DF q_441
rename DG q_442
rename DH q_443
rename DI q_444
rename DJ q_445
rename DK q_446
rename DL q_447
rename DM q_448
rename DN q_449
rename DO q_450
rename DP q_451
rename DQ q_452
rename DR q_453
rename DS q_455
rename DT q_456
rename DU q_457
rename DV q_458
rename DW q_459
rename DX q_460
rename DY q_461
rename DZ q_462
rename EA q_463
rename EB q_464
rename EC q_465
rename ED q_466
rename EE q_468
rename EF q_469
rename EG q_470
rename EH q_471
rename EI q_472
rename EJ q_473
rename EK q_474
rename EL q_475
rename EM q_476
rename EN q_477
rename EO q_478
rename EP q_479
rename EQ q_480
rename ER q_481
rename ES q_482
rename ET q_483
rename EU q_484
rename EV q_485
rename EW q_486
rename EX q_488
rename EY q_489
rename EZ q_490
rename FA q_491
rename FB q_492
rename FC q_493
rename FD q_494
rename FE q_495
rename FF q_496
rename FG q_497
rename FH q_498
rename a q_501a
rename b q_501b
rename c q_501c
rename d q_501d
rename e q_501e
rename f q_501f
rename g q_501g
rename h q_501h
rename i q_501i
rename j q_501j
rename k q_501k
rename l q_501l
rename m q_501m
rename n q_501n
rename o q_501o
rename p q_501p
rename FY q_502a
rename FZ q_502b
rename GA q_502c
rename GB q_502d
rename GC q_502e
rename GD q_502f
rename GE q_502g
rename GF q_502h
rename GG q_502i
rename GH q_502j
rename GI q_502k
rename GJ q_502l
rename GK q_502m
rename GL q_502n
rename GM q_502o
rename GN q_502p
rename GO q_503a
rename GP q_503b
rename GQ q_503c
rename GR q_503d
rename GS q_503e
rename GT q_503f
rename GU q_503g
rename GV q_503h
rename GW q_503i
rename GX q_503j
rename GY q_503k
rename GZ q_503l
rename HA q_503m
rename HB q_503n
rename HC q_503o
rename HD q_503p
rename HE q_504
rename _1 q_505_1
rename _2 q_505_2
rename _3 q_505_3
rename _4 q_505_4
rename _5 q_505_5
rename _6 q_505_6
rename _7 q_505_7
rename _8 q_505_8
rename _9 q_505_9
rename _10 q_505_10
rename _11 q_505_11
rename _12 q_505_12
rename _13 q_505_13
rename _14 q_505_14
rename _15 q_505_15
rename _16 q_505_16
rename _17 q_505_17
rename _18 q_505_18
rename _19 q_505_19
rename _20 q_505_20
rename __21 q_505__21
rename _22 q_505_22
rename _22_specify q_505_22_specify
rename IC q_506_1
rename ID q_506_2
rename IE q_506_3
rename IF q_506_4
rename IG q_506_5
rename IH q_506_6
rename II q_506_7
rename IJ q_506_8
rename IK q_506_9
rename IL q_506_10
rename _10_specify q_506_10_specify
rename IN q_507_1
rename IO q_507_2
rename IP q_507_3
rename IQ q_507_4
rename IR q_507_5
rename IS q_507_6
rename IT q_508
rename IU q_509
rename IV q_509_a
rename IW q_510
rename IX q_511
rename IY q_512_1
rename IZ q_512_2
rename JA q_512_3
rename JB q_512_4
rename JC q_512_5
rename JD q_512_6
rename JE q_512_7
rename JF q_512_8
rename _8_specify q_512_8_specify
rename JH q_513
rename JI q_514
rename JJ q_515
rename JK q_516
rename JL q_517
rename JM q_518_1
rename JN q_518_2
rename JO q_518_3
rename JP q_518_4
rename JQ q_518_5
rename JR q_518_6
rename JS q_518_7
rename JT q_518_8
rename JU q_518_9
rename _9_specify q_518_9_specify
rename JW q_519
rename JX q_520
rename JY q_601
rename JZ q_602_1
rename KA q_602_2
rename KB q_602_3
rename KC q_602_4
rename KD q_602_5
rename KE q_602_6
rename KF q_602_7
rename KG q_602_8
rename KH q_602_9
rename KI q_602_10
rename KJ q_602_11
rename KK q_602_12
rename KL q_602_13
rename KM q_602_14
rename KN q_602_15
rename KO q_602_16
rename KP q_602_17
rename _17_specify q_602_17_specify
rename KR q_603
rename KS q_604_1
rename KT q_604_2
rename KU q_604_3
rename KV q_604_4
rename KW q_604_5
rename KX q_604_6
rename KY q_604_7
rename KZ q_605
rename _specify q_605_specify
rename LB q_606
rename LC q_607_a
rename LD q_607_b
rename LE q_607_c
rename LF q_607_d
rename LG q_607_e
rename LH q_607_f
rename LI q_607_g
rename LJ q_607_h
rename LK q_607_i
rename LL q_607_j
rename LM q_607_k
rename LN q_608_a
rename LO q_608_b
rename LP q_608_c
rename LQ q_608_d
rename LR q_608_e
rename LS q_608_f
rename LT q_608_g
rename LU q_608_h
rename LV q_608_i
rename LW q_608_j
rename LX q_608_k
rename LY q_609_a
rename LZ q_609_b
rename MA q_609_c
rename MB q_609_d
rename MC q_609_e
rename MD q_609_g
rename ME q_609_h
rename MF q_609_i
rename MG q_609_j
rename MH q_609_f
rename MI q_609_k
rename MJ q_610
rename MK q_611
rename ML q_612
rename MM q_613_1
rename MN q_613_2
rename MO q_613_3
rename MP q_613_4
rename MQ q_613_5
rename MR q_613_6
rename MS q_613_7
rename _7_specify q_613_7_specify
rename MU q_613_8
rename MV q_613_9
rename MW q_614_1
rename MX q_614_2
rename MY q_614_3
rename MZ q_614_4
rename NA q_614_5
rename NB q_614_6
rename NC q_614_7
rename ND q_614_7_specify
rename NE q_614_8
rename NF q_614_9
rename NG q_615_1
rename NH q_615_2
rename NI q_615_3
rename NJ q_615_4
rename NK q_615_5
rename NL q_615_6
rename NM q_615_7
rename NN q_615_7_specify
rename NO q_615_8
rename NP q_615_9
rename NQ q_616_1
rename NR q_616_2
rename NS q_616_3
rename NT q_616_4
rename NU q_616_5
rename NV q_616_6
rename NW q_616_7
rename NX q_616_7_specify
rename NY q_616_8
rename NZ q_616_9
rename OA q_617
rename OB q_618_1
rename OC q_618_2
rename OD q_618_3
rename OE q_618_4
rename OF q_618_5
rename _5_specify q_618_5_specify
rename OH q_618_8
rename OI q_618_9
rename OJ q_619_1
rename OK q_619_2
rename OL q_619_3
rename OM q_619_4
rename ON q_619_5
rename OO q_619_6
rename _6_specify q_619_6_specify
rename OQ q_619_8
rename OR q_619_9
rename OS q_620
rename OT q_621_1
rename OU q_621_2
rename OV q_621_3
rename OW q_621_4
rename OX q_621_5
rename OY q_621_5_specify
rename OZ q_621_8
rename PA q_621_9
rename PB q_622_1
rename PC q_622_2
rename PD q_622_3
rename PE q_622_4
rename PF q_622_5
rename PG q_622_6
rename PH q_622_6_specify
rename PI q_622_8
rename PJ q_622_9
rename PK q_623
rename PL q_624_1
rename PM q_624_2
rename PN q_624_3
rename PO q_624_4
rename PP q_624_5
rename PQ q_624_5_specify
rename PR q_624_8
rename PS q_624_9
rename PT q_625_1
rename PU q_625_2
rename PV q_625_3
rename PW q_625_4
rename PX q_625_5
rename PY q_625_6
rename PZ q_625_6_specify
rename QA q_625_8
rename QB q_625_9
rename QC q_626
rename QD q_627_1
rename QE q_627_2
rename QF q_627_3
rename QG q_627_4
rename QH q_627_5
rename QI q_627_5_specify
rename QJ q_627_8
rename QK q_627_9
rename QL q_628_1
rename QM q_628_2
rename QN q_628_3
rename QO q_628_4
rename QP q_628_5
rename QQ q_628_6
rename QR q_628_6_specify
rename QS q_628_8
rename QT q_628_9
rename QU q_629
rename QV q_630
rename QW q_631
rename QX q_632
rename QY q_633
rename QZ q_634
rename RA q_635
rename RB q_636
rename RC q_637
rename RD q_638
rename RE q_701_1
rename RF q_701_2
rename RG q_701_3
rename RH q_701_4
rename RI q_701_5
rename RJ q_701_6
rename RK q_701_7
rename RL q_701_7_specify
rename RM q_702
rename RN q_703
rename RO q_704
rename RP q_705_1
rename RQ q_705_2
rename RR q_705_3
rename RS q_705_4
rename RT q_705_5
rename RU q_705_6
rename RV q_705_7
rename RW q_705_8
rename RX q_705_9
rename RY q_705_10
rename RZ q_705_10_specify
rename SA q_706
rename SB q_707
rename SC q_708
rename _08_specify q_708_08_specify
rename SE q_709
rename SF q_710
rename _11_specify q_710_11_specify
rename SH q_711
rename SI q_712
rename SJ q_713
rename SK q_714
rename SL q_715
rename SM q_716
rename SN q_717
rename SO q_718
rename SP q_719
rename SQ q_720
rename SR q_721
rename SS q_722
rename ST q_723
rename SU q_724
rename SV q_725
rename SW q_726
rename SX q_727
rename SY q_728
rename SZ q_729
rename TA q_730
rename TB q_731
rename TC q_732
rename TD q_733
rename TE q_734
rename TF q_801
rename TG q_801_6_specify
rename TH q_802
rename TI q_803
rename TJ q_804
rename TK q_805
rename TL q_806
rename TM q_807
rename TN q_808
rename TO q_809
rename TP q_810
rename TQ q_811
rename TR q_812
rename TS q_812_7_specify
rename TT q_813
rename TU q_813_7_specify
rename TV q_814
rename TW q_815
rename TX q_816
rename TY q_817
rename TZ q_818
rename UA q_819
rename UB q_820
rename UC q_821
rename UD q_822
rename UE q_823
rename UF q_824
rename UG q_825
rename UH q_826
rename UI q_827
rename UJ q_828
rename UK q_829
rename UL q_830
rename UM q_831
rename UN q_832
rename UO q_901

local numerics q_101 q_206 q_210_b q_211 q_401_a q_401_b q_401_c q_401_d q_401_e q_401_f q_401_g q_401_h q_401_i q_401_j q_401_k q_401_l q_401_m q_401_n q_401_o q_401_p q_401_q q_401_r q_401_s q_401_t q_401_u q_402_a q_402_b q_402_c q_402_d q_402_e q_402_f q_402_g q_402_h q_402_i q_402_j q_402_k q_402_l q_402_m q_402_n q_402_o q_402_p q_402_q q_402_r q_402_s q_402_t q_402_u q_403 q_404 q_405 q_406 q_407 q_408 q_409 q_410 q_411 q_412 q_413 q_414 q_415 q_416 q_417 q_418 q_419 q_420 q_421 q_422 q_423 q_424 q_425 q_426 q_427 q_428 q_429 q_430 q_431 q_432 q_433 q_434 q_435 q_436 q_437 q_438 q_439 q_440 q_441 q_442 q_443 q_444 q_445 q_446 q_447 q_448 q_449 q_450 q_451 q_452 q_453 q_455 q_456 q_457 q_458 q_459 q_460 q_461 q_462 q_463 q_464 q_465 q_466 q_468 q_469 q_470 q_471 q_472 q_473 q_474 q_475 q_476 q_477 q_478 q_479 q_480 q_481 q_482 q_483 q_484 q_485 q_486 q_488 q_489 q_490 q_491 q_492 q_493 q_494 q_495 q_496 q_497 q_498 q_501a q_501b q_501c q_501d q_501e q_501f q_501g q_501h q_501i q_501j q_501k q_501l q_501m q_501n q_501o q_501p q_502a q_502b q_502c q_502d q_502e q_502f q_502g q_502h q_502i q_502j q_502k q_502l q_502m q_502n q_502o q_502p q_503a q_503b q_503c q_503d q_503e q_503f q_503g q_503h q_503i q_503j q_503k q_503l q_503m q_503n q_503o q_503p q_504 q_505_1 q_505_2 q_505_3 q_505_4 q_505_5 q_505_6 q_505_7 q_505_8 q_505_9 q_505_10 q_505_11 q_505_12 q_505_13 q_505_14 q_505_15 q_505_16 q_505_17 q_505_18 q_505_19 q_505_20 q_505__21 q_505_22 q_506_1 q_506_2 q_506_3 q_506_4 q_506_5 q_506_6 q_506_7 q_506_8 q_506_9 q_506_10 q_506_10_specify q_507_1 q_507_2 q_507_3 q_507_4 q_507_5 q_507_6 q_508 q_509 q_509_a q_510 q_511 q_512_1 q_512_2 q_512_3 q_512_4 q_512_5 q_512_6 q_512_7 q_512_8 q_513 q_517 q_518_1 q_518_2 q_518_3 q_518_4 q_518_5 q_518_6 q_518_7 q_518_8 q_518_9 q_519 q_520 q_601 q_602_1 q_602_2 q_602_3 q_602_4 q_602_5 q_602_6 q_602_7 q_602_8 q_602_9 q_602_10 q_602_11 q_602_12 q_602_13 q_602_14 q_602_15 q_602_16 q_602_17 q_603 q_604_1 q_604_2 q_604_3 q_604_4 q_604_5 q_604_6 q_604_7 q_605 q_606 q_607_a q_607_b q_607_c q_607_d q_607_e q_607_f q_607_g q_607_h q_607_i q_607_j q_607_k q_608_a q_608_b q_608_c q_608_d q_608_e q_608_f q_608_g q_608_h q_608_i q_608_j q_608_k q_609_a q_609_b q_609_c q_609_d q_609_e q_609_g q_609_h q_609_i q_609_j q_609_f q_609_k q_610 q_611 q_612 q_613_1 q_613_2 q_613_3 q_613_4 q_613_5 q_613_6 q_613_7 q_613_8 q_613_9 q_614_1 q_614_2 q_614_3 q_614_4 q_614_5 q_614_6 q_614_7 q_614_8 q_614_9 q_615_1 q_615_2 q_615_3 q_615_4 q_615_5 q_615_6 q_615_7 q_615_8 q_615_9 q_616_1 q_616_2 q_616_3 q_616_4 q_616_5 q_616_6 q_616_7 q_616_8 q_616_9 q_617 q_618_1 q_618_2 q_618_3 q_618_4 q_618_5 q_618_8 q_618_9 q_619_1 q_619_2 q_619_3 q_619_4 q_619_5 q_619_6 q_619_6_specify q_619_8 q_619_9 q_620 q_621_1 q_621_2 q_621_3 q_621_4 q_621_5 q_621_8 q_621_9 q_622_1 q_622_2 q_622_3 q_622_4 q_622_5 q_622_6 q_622_6_specify q_622_8 q_622_9 q_623 q_624_1 q_624_2 q_624_3 q_624_4 q_624_5 q_624_8 q_624_9 q_625_1 q_625_2 q_625_3 q_625_4 q_625_5 q_625_6 q_625_8 q_625_9 q_626 q_627_1 q_627_2 q_627_3 q_627_4 q_627_5 q_627_8 q_627_9 q_628_1 q_628_2 q_628_3 q_628_4 q_628_5 q_628_6 q_628_6_specify q_628_8 q_628_9 q_629 q_630 q_631 q_632 q_633 q_634 q_635 q_636 q_637 q_638 q_701_1 q_701_2 q_701_3 q_701_4 q_701_5 q_701_6 q_701_7 q_702 q_703 q_704 q_705_1 q_705_2 q_705_3 q_705_4 q_705_5 q_705_6 q_705_7 q_705_8 q_705_9 q_705_10  q_706 q_707 q_708 q_708_08_specify q_709 q_710 q_711 q_713 q_715 q_717 q_719 q_721 q_723 q_725 q_727 q_729 q_731 q_733 q_801 q_802 q_803 q_804 q_805 q_806 q_807 q_808 q_809 q_810 q_811 q_812 q_813 q_814 q_815 q_816 q_817 q_818 q_819 q_820 q_821 q_822 q_823 q_824 q_825 q_826 q_827 q_828 q_829 q_830 q_831 q_832 

foreach num of local numerics {
destring `num', replace
}
*
replace q_514="."
destring q_514, replace
replace q_515="."
destring q_515, replace
replace q_516="."
destring q_516, replace

*Apply codebook
applyCodebook using "`outpath'01_south_sudan_pilot_codebook_hh_survey.xlsx", rename varlab recode vallab

*Save dataset as dta file
save "`outpath'mesp_household_pilot_survey_juba_arabic_preprocessed.dta", replace

**********************
* Household Schedule *
**********************

*Import raw dataset
import excel using "`inpath'mesp_household_baseline_survey_juba_arabic.xlsx", firstrow sheet("mesp_household_baseline_surve_1") clear

rename T q_301
rename U q_302
rename V q_303
rename W q_304
rename X q_305
rename Y q_306
rename Z q_307
rename AA q_308
rename _8_specify q_308_8_specify 
rename AC q_309
rename _7_specify q_309_7_specify
rename AE q_310
rename AF q_311
rename AG q_312
rename AH q_313
rename AI q_314
rename _10 q_314_10_specify
rename AK q_315

local numerics q_302 q_303 q_304 q_305 q_306 q_307 q_308 q_309 q_310 q_311 q_312 q_313 q_314 q_315

foreach num of local numerics {
destring `num', replace
}
*

*Apply codebook
applyCodebook using "`outpath'01_south_sudan_pilot_codebook_hh_survey_hh_schedule.xlsx", rename varlab recode vallab

*Save dataset as dta file
save "`outpath'mesp_household_pilot_survey_juba_arabic_hh_schedule_preprocessed.dta", replace
